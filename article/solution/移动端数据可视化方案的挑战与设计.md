# 移动端数据可视化方案的挑战与设计
**需求永远在预期之外**  
移动端可视化展现时经常会碰到一些问题
1. 圆角提示能实现吗,官网上也没看到有类似的样式
2. 环图能实现这种选中样式吗？它和你们默认提供的差异也很大
3. 多层嵌套能实现

## 渲染引擎  
渲染引擎是解决核心的图形渲染渲染能力，可视化需要将数据可视化展示出来，所以这个就是离不开核心的渲染能力，而我们在底层实现了一套统一的渲染引擎 G  
**渲染能力**  
在渲染引擎层，实现了统一的渲染能力，可以通过简单且一致的方式，快速实现 UI 的绘制  
**事件系统**  
除了 UI 绘制能力外，还实现了标准的事件系统  
**动画系统**  
动画也是可视化里面一项很核心的功能，我们 G 里也实现了一套完整的动画系统  
**统一的渲染引擎 FEngine**  
实现了一套类似浏览器的渲染能力，可以让我们非常方便地构造 UI，通过声明式的标签，就可构造任意我们先要表达的样式，而且使用方式和 DOM 基本一直，可以非常方便地上手并使用。  

## 可视化能力
可视化能力就是将数据进行可视化输出的能力，那么在讲可视化能力之前，先简单看下可视化流程  
可视化的流程用一句话概括就是「将数据映射到图形」的过程。当然在映射过程中，还经历了「数据整理」、「数据映射」、「数据补全」、「图像处理」等一些列过程。   
数据映射的核心就是将抽象的数据映射成图形的几何数据 (位置、大小，颜色等)，而如果我们再来看前面的需求，我们就会发现，大部分的差异都是在 UI 的差异上，所以如果我们将映射的逻辑和 UI 绘制的逻辑分开，是不是就能解决大部分问题呢，基于这个思路，我们底层把数据映射和 UI 界面逻辑分离，通过 逻辑 + UI 的方式形成完整的功能组件  
通过这种方式，我们在复用数据映射逻辑的基础上，实现了 UI 的灵活自定义，而我们可视化的核心也变成了丰富的数据映射能力，和简单易用的 UI 构造能力  
## 扩展与定制
通过逻辑和 UI 的分离，实现了 UI 的灵活定义能力，但是当我们面向某个特定场景时，往往会发现某个场景下的 UI 样式有很大的共性，在实际场景中，我们一定希望会有一定的沉淀和复用，而基于逻辑 和 UI 分离的模式，我们可以将一个图表进行原子化的拆解，形成细粒度的原子组件，再通过原子组件的组合模式，实现共性的复用  
对于场景的样式风格都很接近，可以通过原子化的拆解，形成单一的原子组件，再通过原子组件组合的方式，去形成完整的可视化图表，把这种模式叫做领域方案的定制，当随着我们原子组件的丰富，组合图表的丰富度也将得到大量的提升，而且有了统一的沉淀，我们可以实现统一的升级和迭代。将极大方便我们整体的可视化开发。  
## 跨端能力
在移动端面临的已经不仅仅只有 H5 了，还有小程序、甚至是 Native ，而在实际的业务场景中，我们永远希望一套代码能随处运行  
针对移动端的跨端方案，我们可以分成 2 部分去看，「面向 Web 的跨端能力」和「面向 Native 的跨端能力」，因为 web 技术栈 和 非 web 技术栈面临的差异和挑战是巨大的  
**面向 Web 的跨端能力**  
Web 技术栈的跨端方案相对会比较简单，只要基于底层的绘图技术，在上面封装统一的实现，让后针对不同的端环境和技术栈进行响应的封装和适配，通过统一的标准就能达到统一的目的  
**面向 Native 的跨端能力**  
面向非 Web 技术栈的跨端方案就会变得复杂很多，因为我们底层根本没有浏览器存在，也没有浏览器给我们提供的 canvas、svg、webgl 等这些绘图能力，所以针对 native 的跨端场景上，我们在底层实现类似浏览器 Canvas 的 Native Canvas 来实现 Native 侧的渲染能力。并基于 Native Canvas 我们在上层实现了 同 G 类似的渲染引擎，来实现统一的渲染接口 API，基于统一的底层，我们就可以在上层实现完全的一套代码多端运行  




原文: 
[移动端数据可视化方案的挑战与设计](https://mp.weixin.qq.com/s/no_NZmON_1Hct4AhFZsFyQ)
