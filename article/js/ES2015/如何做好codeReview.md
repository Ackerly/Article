# 如何做好CodeReview
## 概述
任何软件都是协同开发，CodeReview非常重要，可以帮助你减少代码质量问题，提高开发效率，提升稳定性，同时保证软件架构的稳定性，防止代码结构被恶意破坏导致难以维护。
## CodeView的覆盖范围
**Good CodeReview会检查代码的正确性，测试覆盖率，功能变化、是否遵循代码规范与最佳实践、指出一些较为明显的改进点，比如难以阅读的写法、未使用到的变量、一些边界问题，commit数量过大需要拆分等等**  
**Better CodeReview会检查引入代码的必要性，与已有系统是否匹配，是否具有可维护性，从抽象角度思考代码是否与已有系统逻辑能够自洽。**  
Better CodeReview会关注可维护性层面，并具有全局性，往往几个局部正确代码组合在一起会产生错误的结果，或者没必要的代码，或者互相冲突的逻辑。Better CodeReview更多用在底层架构场景，因为底层模块关联紧密需要整体视角，业务上层模块间最好采用解耦模式，这样不需要更好费精力的Better CodeReview，也是一种更正确的架构设计。
## CodeReview的语气  
**Good CodeReview会给出建设性意见，而不是发表强烈措辞要求对方改正，或者认为自己的意见是唯一正确的答案**  
**Better CodeReview永远考虑全面且正向积极的，会对写的好的进行鼓励，对写的不好的地方体现出善解人意的关怀，考虑到对方肯能花费了很多心血，以一种换位思考的鼓励心态进行评论**
CodeReview不仅是一个技术专业行为，还是一个与人相处的社交行为，有人与人打交道非常谦逊，但是CodeReview变得尖酸刻薄。z做到Better CodeReview需要换位思考，体现包容，正向积极的态度，因为技术经验更丰富能指出别人的问题很正常，但能保持谦逊，让别人容易接受并受到鼓励，可以让你成为一个有气度的技术专家。
## 如何完成CodeReview的审阅
Good CodeReview不会轻易通过哪些开放式PR，至少在其被得到充分的讨论前，每个Review对自己关注部分完成Review需要进行反馈，并且需要明确的跟进，比如通过软件通知作者进行进一步反馈。  
Better CodeReview执行会更加灵活，对于一些比较紧急的改动会留下改进建议，但快速通过，让作者后续代码提交解决遗留的问题。  
实际工作会遇到开发式或紧急的提胶片，良好的CodeReview自然要严谨一些，讨论清除再通过，并且及时反馈。紧急的提交就需要区别对待，更好的态度是在实践中灵活对待，但及时紧急通过也要保证问题在后续得以修复，比如留“TODO”或“FIXME”的标记，写上对应负责人和语气解决时间。
## 从CodeReview到直接交流
Good CodeReview给出完成评论和修改建议，如果后续提交的代码不符合预期，Review者可以直接与提交者面对面交流，这样避免后续花费更多花沟通时间。
Better CodeReview会在第一次给出完成的评论和修改建议，如果后续提交代码不符合预期，会立即与代码提交者当面沟通，避免异步沟通带来更多的理解偏差。  
补充：PR内容过多时可以选择当面交流，这样可以更理解作者的想法，是Review准确性更高。另外不要每次都直接交流，异步的CodeReview本身就是一种提效方案，仅在方案出现沟通问题时再选择当面交流。
## 区分重点
Good CodeReview可以区分提示重要程度，在不太重要的改动前面加上“nit:”,这样可以使提交者的注意力集中在重要的问题上。  
Better CodeReview会采取工具手段解决这些问题，比如lint工具，因为这些问题往往可以被自动化解决  
代码自动化工具的目的很大一部分是为了保证代码一致性，降低CodeReview成本，也减少不重要的评论信息出现，让CodeReview尽可能反馈逻辑问题而不是格式问题。

## 针对西能的CodeReview
Good CodeReview对任何人都是用相同评判标准，可以遵循上面几点注意事项。  
Better CodeReview对西能区分对待，对新人给予多的耐心、解释和评论，甚至给出解决方法，并更积极的给出鼓励。
## 跨办公区、时区的CodeReview
Good CodeReview仅在工作时间有重叠的时间范围内进行CodeReview，这样保证对方可以积极响应，必要时进行语音、视频沟通
Better CodeReview会注意到更本质问题，留意团队协作的必要性，如果摸个模块经常被另一个时区同时修改，可以将这个模块交给对方维护，或者将CodeReview交给对方团队内部更加高效。
## 公司支持
Good CodeReview看起来虽然占用开发时间，长远看提升了开发效率  
Better CodeReview会得到公司进一步支持，公司甚至不断研发完善CodeReview系统与流程，通过系统化方案保证上面几项CodeReview注意事项是否在团队落实，全员参与。

参考：  
[精读《如何做好 CodeReview》](https://github.com/ascoders/weekly/blob/master/%E5%89%8D%E6%B2%BF%E6%8A%80%E6%9C%AF/142.%E7%B2%BE%E8%AF%BB%E3%80%8A%E5%A6%82%E4%BD%95%E5%81%9A%E5%A5%BD%20CodeReview%E3%80%8B.md)
