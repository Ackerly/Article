# 项目稳定性治理：十五个防御性CSS技能
防御性CSS:一切使表现和行为偏离预期效果的情景.  
出现这些场景的原因是因为终端环境的多样化，开发及测试用例只能覆盖大多数使用场景，在其他环境下，解析机制差异、内容动态变化等，都是导致非预期效果的原因。  
**防御的必要性**  
防御性CSS不仅仅是为了兼容其他少数场景，避免边界情况，更大的价值在于提升团队协作的可能性。防御性CSS的意义类似JS中的try...catch, 他可能无法缩短需求开发的时间，但却是你程序正确运行和稳定运行的最后一道防线，更何况JS的错误只有在用户交互后才有感知，而CSS一旦出错，直接赤裸裸的展现在用户面前，直接影响用户的使用率和留存率。
都说编程风格分为三种：能跑就行风格、中规中矩风格、锦上添花风格。能跑就行风格代表的是：每一个设定和判断都和当次需求贴合的严丝合缝，如同山羊走钢丝，摇摇欲坠，但就是不倒，不得不令人称奇，但这种风格，不仅对编程人员要求极高，而且十分不利于团队协作，一旦意料意外的情景发生或者需求变更，带来的是雪崩式的改动；中规中矩风格概述为，该写注释的地方写注释，该写思路的地方写自己这么做的理由，该兜底处理的地方做拦截处理，程序的鲁棒性和可维护性直接拉满；万无一失风格更多的像是处女座，追求极致和完美，在中规中矩风格上再增一抹亮色，年轻时候的“雷布斯”就是典型代表。防御性CSS的目的就是从技术上尽可能的改变编程者能跑就行的侥幸心理，提升项目的可用性和可维护性。其目的也可以归纳为让你的项目做到：跑起来不出错，改起来不骂人。  
## 防御技能
**flex-wrap**  
属性背景：flex-wrap是flex布局中的属性，其作用是控制flex容器内元素所占空间超出flex容器空间时是否折行。  
防御原因：flex-wrap属性默认是不折行，容易忽略多元素溢出兜底；为兜底，请设置flex-wrap: wrap;  
意外后果：内部元素被裁剪，或flex容器出现滚动条；  
应用场景：  
1. 开发中flex容器空间够用，但小尺寸屏幕会溢出；
2. 内容由服务端下发，元素个数无法提前预支，超于预期时导致flex容器出现滚动条或内部元素被裁剪；

代码：  
```
.options-list {
    display: flex;
    flex-wrap: wrap;
}
```
**margin间距**  
属性背景：margin作用是调整元素的外边距。用于指定元素与周围空间的距离关系。  
防御原因：防止元素与元素之间挤压空间，造成重叠等情况；  
意外后果：元素重叠或被挤压；  
应用场景：  
1. 内容所占空间无法保证与其他元素不存在挤压的场景；

代码：
```
.section__title {
    margin-right: 1rem;
}
```
**长文本处理**  
背景：当文本长度超出容器时，该如何显示。  
意外后果：文本折行，样式不统一；  
应用场景：  
1. 要求列表表现一致但文本长度不可控；

此处假设与设计最终商定，超出部分以省略显示，那么，意外兜底的样式代码为：  
```
.username {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
```
**防止图像被拉伸或压缩**  
背景：通常，服务器下发的图片尺寸以及用户自定义上传的图片，显示在页面时，不可能百分百与容器尺寸贴合，不可避免的会遇到图片的放缩处理。  
意外后果：图像被拉伸或压缩；  
应用场景：  
1. 服务端下发多种不确定尺寸的图片；
2. 用户自定义上传图片且需要预览和编辑；

```
.card__thumb {
    object-fit: cover;
}
```

参考：  
[项目稳定性治理：十五个防御性CSS技能](https://juejin.cn/post/7068993477312413733?utm_source=gold_browser_extension)