# 前端构建大型应用
## 框架选择
### Angular
这里的 Angular 是指 Angular 2.0+ 版本，v1.0 我们通常称之为 AngularJS，目前已经不更新了，建议使用 Angular。  
Angular 相对 React 和 Vue，最初的设计是针对大型应用来进行的。要是你认识 JAVA 的话，像依赖注入这一套你会觉得很熟悉。当然到了 v2.0 以上的版本由于加入了很多的语法糖，看起来 AngularJS 和 Angular 相差很远，但是最核心的依赖注入模式还是相似的。  
项目中使用 Angular，最大的体验感受则是项目有完备的结构和规范，新加入的成员能很快地通过复制粘贴完成功能的开发。好的架构设计，能让高级程序员和初入门的程序员写出相似的代码，这样对于整体管理和项目的维护有非常好的体验。
Angular 难上手主要在于开始的项目搭建、以及 Angular 独有的一套设计方案的理解。但是依赖注入的设计方式，几乎不用考虑很多数据和状态管理的问题。当然脏检查的方式曾经也带来性能问题，后面在加入树状的模块化、Zone.js 之后，即使没有虚拟 DOM，性能也是有大大的提升。
### React
React的特点是jsx、虚拟 DOM、函数式编程的设计，在使用 React 的时候，会接触到很多好的设计，去引领你进行更深入的思考。函数式编程的方式，也会不同程度地拓展你的思考方式，遇到问题的时候，能有更多的解决办法。  
### vue
Vue像Angular和React的结合体。Vue 最大的特点是上手简单，不管是框架的设计和文档，都对新手极其友好。但是这并不代表它只是个简单的框架，当你需要实现一些更加深入的自定义功能时，你会发现它其实也有很好的功能支持。如果你还认为它只是把 Angular 和 React 的优势结合，在你深入使用甚至阅读源码的时候，你会慢慢发现里面的一些自己的思考，真的是个很棒的框架。  
## 开源框架
使用开源框架的好处是，有着完整详细的文档，同时有问题也能通过 issues 和 Stack Overflow (opens new window)来查找  
更多时候，我们选择一个框架，需要考虑项目大小、定位。**技术选型更多的在于团队，你要考虑这个团队的能力、大家对各个框架的熟悉程度、是否有强烈的倾向。**或者有能力的团队，也可以选择相对小众的框架。  
尽量在对这些新技术有较好地把握之后，再尝试一点点加入我们的项目里。项目尤其是工程项目，大多数是解决某些问题，我们需要在满足业务和项目维护性的同时，来做一些新的尝试。  
## 项目代码结构
好的项目代码结构会大大提升项目的维护性。同时可以提供友好的说明，以便其他成员理解项目和快速定位。
``` 
# Angular
│
├── src/                              # 项目代码存放位置
│   │
│   ├── app/                          # app相关代码
│   │   ├── modules/                  # 业务模块
│   │   ├── shared/                   # 公用组件/服务等
│   │   └── container/                # Angular应用入口文件（路由、启动模块等）
│   │
│   ├── assets                        # 相关资源
│   ├── environments/                 # 环境相关配置
│   │
│   ├── index.html                    # 主页面
│   └── main.ts                       # angular启动文件
│
├── dist/                             # 存放编译打包生成文件
├── e2e/                              # e2e测试相关文件
├── .gitignore                        # Git上传相关配置
├── package.json                      # npm相关配置
├── README.md                         # 说明文档
└── xxx.json/xxx.js/.xxxx             # 其他配置文档
```
``` 
# Vue
│
├── src/                              # 项目代码存放位置
│   │
│   ├── app/                          # app相关代码
│   │
│   ├── components/                   # 公用组件
│   ├── router/                       # 路由配置
│   ├── store/                        # store
│   │
│   ├── index.html                    # 主页面
│   ├── main.js                       # 启动文件
│   |
│   └── ...                           # 其他文件
│
├── dist/                             # 存放编译打包生成文件
├── config/build/                     # 项目构建相关配置
├── .gitignore                        # Git上传相关配置
├── package.json                      # npm相关配置
├── README.md                         # 说明文档
└── xxx.json/xxx.js/.xxxx             # 其他配置文档
```
可以在搭建项目的时候，在 README.md 里面描述下该项目下的代码和文件结构
## 代码流程规范
代码规范其实是团队合作中最重要的地方，使用相同的代码规范，会大大减少我们接手别人代码时候卧槽的次数。  
好的写码习惯很重要，命名习惯、适当的注释，会对代码的可读性有很大的提升。但是习惯是每个人都不一样，所以在此之上，我们需要有这样统一的代码规范。  
一些工具可以很好地协助我们，像 Eslint、Tslint 等，加上代码的打包工具协助，可以把一些规范强行标准化，来获取代码的统一性。还有像 prettier 这样的工具，能自动在打包的时候帮我们进行代码规范化。
## 大型应用优化
### 路由管理
路由管理其实主要是当项目变大方便管理，同时为了项目体验问题而引入的解决方案。毕竟产品设计都比较成熟，对用户来说刷新页面会丢掉页面状态，这样的体验是在是太糟糕了。  
规划项目路由的时候，会推动我们对项目业务、功能区块化有更加深入的认识和理解。同时对我们的项目结构规划也有很大的帮助，我们可以根据路由来放置我们的代码文件，有了这样的约定，我们在维护他人代码的时候，便能迅速地定位到对应的位置。
### 抽象和组件化
当开始写重复的代码、或是进行较多的复制粘贴的时候，大概我们需要考虑对组件进行适当的抽象了。  
好的抽象能大量减少重复代码，同时对项目整体有更深入的理解。坏的抽象会增加项目的复杂度，同时降低了代码的可读性和维护性。所以关键在于适度，好的办法是结合产品和业务来进行抽象，例如一个播放器组件、日历组件、快速导航栏、快捷菜单等组件封装，便于多次使用。
### Webpack 分块打包  
使用 Webpack 的话，可以用：  
- CommonsChunkPlugin：提取代码中的公共模块，然后将公共模块打包到一个独立的文件中，以便在其他的入口和模块中使用
- ExtractTextPlugin：可以将样式或其他从 js 中抽出，生成单独的.css样式文件
- require.ensure()
    - webpack 在编译时，会静态地解析代码中的require.ensure()，同时将模块添加到一个分开的 chunk 当中
    - 这个新的 chunk 会被 webpack 通过 jsonp 来按需加载
###Source map
ource map 就是一个信息文件，里面储存着位置信息。也就是说，转换后的代码的每一个位置，所对应的转换前的位置。有了它，出错的时候，除错工具将直接显示原始代码，而不是转换后的代码。  
开发环境下，还能通过 Chrome 匹配源文件进行在线 debug 和修复源码。

参考:  
[前端构建大型应用](https://godbasin.github.io/front-end-playground/front-end-basic/deep-learning/build-application.html#%E6%A1%86%E6%9E%B6%E9%80%89%E6%8B%A9)
