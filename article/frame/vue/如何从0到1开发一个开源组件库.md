# 如何从0到1开发一个开源组件库
## Monorepo 架构
采用了拆包的架构, 通过yarn workspace和lerna实现.把通用的依赖都做成一个包进行单独发布，在构建组件库的过程中也可以同时产出一些实用的工具，也为后期项目的扩展打下了基础。lerna有着完善的发包机制，让我们不需要太关心包和包之间的依赖关系。组件库则设计成其中的一个子包
## Design System
不建议在没有设计系统的情况下进行组件库的开发，因为自己拍脑门想出来的设计总是会那么的不合理。最好选择开源并且成熟的设计系统，比如Material Design，Vercel Design。
## 相关工具
最基本的开发要求
- 开发环境，搭建服务去调试代码
- 支持按需引入
- 组件库编译，生成umd和esm模块的组件代码
- 构建开发文档
- 单元测试
- 桌面端和移动端的组件预览
- 代码格式化和规范检测工具
- 自动化的文档部署和测试流程
## 开发环境
采用了webpack5和webpack-dev-server构建了一个官方文档站点，基于自定义的插件进行了src目录的扫描，提取出了有用的信息并构建了基础的路由和文档配置。关于文档编写我们是通过varlet-markdown-loader将md文件编译成了vue template string渲染在了每一个路由模块中，使得文档编写更加容易。
## 组件库编译器
需要把组件代码导出成umd和esm模块来提供给用户使用，没有使用rollup，而是选择自己实现组件库的编译器。译组件其实核心就是扫描整个目录，扫到什么格式的文件就用对应的编译器去过一遍他。自己实现可以在编译过程中添加很多的优化，并且是完全自由可控的，可以生成我们希望生成的模块结构，也方便我们实现按需引入。
## 组件原型设计与重构
对原型进行评审，进行深入的讨论，最后会对组件进行重写，确定api，补全文档，完成单测，最后发布。不要畏惧重写和推翻，也不要奢求一步到位。
## 组件发布
semver 语义化版本规范, 也就是1(主版本号).0(次版本号).0(修订版本号)这样的模式。有破坏性的更新动第一位，有新功能动第二位，改改bug动第三位。完成了一个版本，但是对版本的更新内容心里没底的时候，记得先发alpha版本，进行生产上的反复测试。对于已经有很大用户量的项目，应该每次更新都有着alpha, beta, rc乃至更多的先行版本，来给正式版本提供可靠性保障。
## Git Actions 自动部署和测试
当项目的贡献者越来越多时，一些贡献者不可避免会犯一些流程错误。比如提交代码时忘记跑单元测试，没有尝试对项目进行生产模式的构建等等，为了避免错误，我们需要在提交代码到git远程仓库时去做一些流程性的任务，也就是我们常说的ci/cd或者流水线。又比如说每次发布新版本，不可避免的需要对文档进行重新部署，每次都手动部署也太麻烦了，这种流程性的任务也可以解决我们的问题。Git Actions可以很好的解决我们的问题，我们可以让它帮我们执行单元测试和代码校验，帮我们做github和gitee的同步，帮我们做文档的部署，
## PR，ISSUE规范
一个开源项目一定会收到许多pr和issue，为了更快的定位bug和解决问题，可以在github仓库提供pr和issue的模板来解决这一问题。也可以提供贡献指南或者开发手册，让有兴趣的人更快的可以参与进来。

原文: 
[Vue组件库 | 如何从0到1开发一个开源组件库](https://juejin.cn/post/7010553100222070792)
