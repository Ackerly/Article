# ä¸ºä»€ä¹ˆVueå’ŒReactéƒ½é€‰æ‹©äº†Hooks
**hooks çš„å®šä¹‰**  
"hooks" ç›´è¯‘æ˜¯ â€œé’©å­â€ï¼Œå®ƒå¹¶ä¸ä»…æ˜¯ reactï¼Œç”šè‡³ä¸ä»…æ˜¯å‰ç«¯ç•Œçš„ä¸“ç”¨æœ¯è¯­ï¼Œè€Œæ˜¯æ•´ä¸ªè¡Œä¸šæ‰€ç†ŸçŸ¥çš„ç”¨è¯­ã€‚é€šå¸¸æŒ‡ï¼š  
> ç³»ç»Ÿè¿è¡Œåˆ°æŸä¸€æ—¶æœŸæ—¶ï¼Œä¼šè°ƒç”¨è¢«æ³¨å†Œåˆ°è¯¥æ—¶æœºçš„å›è°ƒå‡½æ•°ã€‚

æ¯”è¾ƒå¸¸è§çš„é’©å­æœ‰ï¼šwindows ç³»ç»Ÿçš„é’©å­èƒ½ç›‘å¬åˆ°ç³»ç»Ÿçš„å„ç§äº‹ä»¶ï¼Œæµè§ˆå™¨æä¾›çš„ onload æˆ–addEventListener èƒ½æ³¨å†Œåœ¨æµè§ˆå™¨å„ç§æ—¶æœºè¢«è°ƒç”¨çš„æ–¹æ³•ã€‚  
åœ¨ react@16.x ä¹‹å‰ï¼Œå½“æˆ‘ä»¬è°ˆè®º hooks æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½è°ˆè®ºçš„æ˜¯â€œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸâ€ã€‚ä½†æ˜¯ç°åœ¨ï¼Œhooks åˆ™æœ‰äº†å…¨æ–°çš„å«ä¹‰,ä»¥ react ä¸ºä¾‹ï¼Œhooks æ˜¯ï¼š  
ä¸€ç³»åˆ—ä»¥ â€œuseâ€ ä½œä¸ºå¼€å¤´çš„æ–¹æ³•ï¼Œå®ƒä»¬æä¾›äº†è®©ä½ å¯ä»¥å®Œå…¨é¿å¼€ classå¼å†™æ³•ï¼Œåœ¨**å‡½æ•°å¼ç»„ä»¶**ä¸­å®Œæˆç”Ÿå‘½å‘¨æœŸã€çŠ¶æ€ç®¡ç†ã€é€»è¾‘å¤ç”¨ç­‰å‡ ä¹å…¨éƒ¨ç»„ä»¶å¼€å‘å·¥ä½œçš„èƒ½åŠ›ã€‚
```
import { useState, useEffect, useCallback } from 'react';
// æ¯”å¦‚ä»¥ä¸Šè¿™å‡ ä¸ªæ–¹æ³•ï¼Œå°±æ˜¯æœ€ä¸ºå…¸å‹çš„ Hooks
```
è€Œåœ¨ vue ä¸­hooks çš„å®šä¹‰å¯èƒ½æ›´æ¨¡ç³Š,åœ¨ vue **ç»„åˆå¼API**é‡Œï¼Œä»¥ â€œuseâ€ ä½œä¸ºå¼€å¤´çš„ï¼Œä¸€ç³»åˆ—æä¾›äº†ç»„ä»¶å¤ç”¨ã€çŠ¶æ€ç®¡ç†ç­‰å¼€å‘èƒ½åŠ›çš„æ–¹æ³•,å¦‚ï¼šuseSlotsã€ useAttrsã€ useRouter ç­‰ã€‚ 
```
import { useSlots, useAttrs } from 'vue';
import { useRouter } from 'vue-router';
// ä»¥ä¸Šè¿™äº›æ–¹æ³•ï¼Œä¹Ÿæ˜¯ vue3 ä¸­ç›¸å…³çš„ Hookï¼
```
ä½†ä¸»è§‚æ¥è¯´vue ç»„åˆå¼APIå…¶æœ¬èº«å°±æ˜¯â€œvue hooksâ€çš„å…³é”®ä¸€ç¯ï¼Œèµ·åˆ°äº† react hooksé‡Œå¯¹ç”Ÿå‘½å‘¨æœŸã€çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒä½œç”¨ã€‚ï¼ˆå¦‚ onMountedã€ ref ç­‰ç­‰ï¼‰ã€‚  
**å‘½åè§„èŒƒ å’Œ æŒ‡å¯¼æ€æƒ³**  
åœ¨ react å®˜æ–¹æ–‡æ¡£é‡Œ
- å‡è®¾ä»»ä½•ä»¥ã€Œuseã€å¼€å¤´å¹¶ç´§è·Ÿç€ä¸€ä¸ªå¤§å†™å­—æ¯çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ª Hook
- åªåœ¨ React å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hookï¼Œè€Œä¸åœ¨æ™®é€šå‡½æ•°ä¸­è°ƒç”¨ Hook
- åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hookï¼Œè€Œä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚
  
## ä¸ºä»€ä¹ˆéœ€è¦ hooks**  
### æ›´å¥½çš„çŠ¶æ€å¤ç”¨ 
åœ¨ class ç»„ä»¶æ¨¡å¼ä¸‹ï¼ŒçŠ¶æ€é€»è¾‘çš„å¤ç”¨æ˜¯ä¸€ä»¶å›°éš¾çš„äº‹æƒ…ã€‚  
å‡è®¾æœ‰å¦‚ä¸‹éœ€æ±‚ï¼š  
> å½“ç»„ä»¶å®ä¾‹åˆ›å»ºæ—¶ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ª state å±æ€§ï¼šnameï¼Œå¹¶éšæœºç»™æ­¤ name å±æ€§é™„ä¸€ä¸ªåˆå§‹å€¼ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¾—æä¾›ä¸€ä¸ª setName æ–¹æ³•ã€‚å¯ä»¥åœ¨ç»„ä»¶å…¶ä»–åœ°æ–¹å¼€é”€å’Œä¿®æ”¹æ­¤çŠ¶æ€å±æ€§ã€‚  
> æ›´é‡è¦çš„æ˜¯: è¿™ä¸ªé€»è¾‘è¦å¯ä»¥å¤ç”¨ï¼Œåœ¨å„ç§ä¸šåŠ¡ç»„ä»¶é‡Œå¤ç”¨è¿™ä¸ªé€»è¾‘

åœ¨æ‹¥æœ‰ Hooks ä¹‹å‰ï¼Œé¦–å…ˆä¼šæƒ³åˆ°çš„è§£å†³æ–¹æ¡ˆä¸€å®šæ˜¯ mixin,ä»£ç å¦‚ä¸‹ï¼š
```
// æ··å…¥æ–‡ä»¶ï¼šname-mixin.js
export default {
  data() {
    return {
      name: genRandomName() // å‡è£…å®ƒèƒ½ç”Ÿæˆéšæœºçš„åå­—
    }
  },
  methods: {
    setName(name) {
      this.name = name
    }
  }
}
// ç»„ä»¶ï¼šmy-component.vue
<template>
  <div>{{ name }}</div>
<template>
<script>
import nameMixin from './name-mixin';
export default {
  mixins: [nameMixin],
  // é€šè¿‡mixins, ä½ å¯ä»¥ç›´æ¥è·å¾— nameMixin ä¸­æ‰€å®šä¹‰çš„çŠ¶æ€ã€æ–¹æ³•ã€ç”Ÿå‘½å‘¨æœŸä¸­çš„äº‹ä»¶ç­‰
  mounted() {
    setTimeout(() => {
      this.setName('Tom')
    }, 3000)
  }
}
<script>
```
mixins è™½ç„¶æä¾›äº†è¿™ç§çŠ¶æ€å¤ç”¨çš„èƒ½åŠ›ï¼Œä½†å®ƒçš„å¼Šç«¯å®åœ¨å¤ªå¤šäº†
**éš¾ä»¥è¿½æº¯çš„æ–¹æ³•ä¸å±æ€§**
```
export default {
  mixins: [ a, b, c, d, e, f, g ], // å½“ç„¶ï¼Œè¿™åªæ˜¯è¡¨ç¤ºå®ƒæ··å…¥äº†å¾ˆå¤šèƒ½åŠ›
  mounted() {
    console.log(this.name)
    // mmp!è¿™ä¸ª this.name æ¥è‡ªäºè°ï¼Ÿæˆ‘éš¾é“è¦ä¸€ä¸ªä¸ªæ··å…¥çœ‹å®ç°ï¼Ÿ
  }
}
```
**è¦†ç›–ã€åŒå**  
åŒæ—¶æƒ³æ··å…¥ mixin-a.js å’Œ mixin-b.js ä»¥åŒæ—¶è·å¾—å®ƒä»¬èƒ½åŠ›çš„æ—¶å€™ï¼Œä¸å¹¸çš„äº‹æƒ…å‘ç”Ÿäº†ï¼š  
ç”±äºè¿™ä¸¤ä¸ª mixin åŠŸèƒ½éƒ½å®šä¹‰äº† this.name ä½œä¸ºå±æ€§,å¯¼è‡´ç¬¬ä¸€ä¸ªnameè¢«è¦†ç›–ï¼Œè¿™ç§æ—¶å€™ï¼Œä½ ä¼šæ·±æ·±æ€€ç–‘ï¼Œmixins ç©¶ç«Ÿæ˜¯ä¸æ˜¯ä¸€ç§ç§‘å­¦çš„å¤ç”¨æ–¹å¼ã€‚  
**ä»£ä»·å¾ˆå¤§**  
å¦‚æœæˆ‘çš„éœ€æ±‚å‘ç”Ÿäº†æ”¹å˜ï¼Œä¸å†æ˜¯ä¸€ä¸ªç®€å•çš„çŠ¶æ€ nameï¼Œè€Œæ˜¯åˆ†åˆ«éœ€è¦ firstName å’Œ lastNameã€‚æ­¤æ—¶ name-mixin.js æ··å…¥çš„èƒ½åŠ›å°±ä¼šéå¸¸å°´å°¬å› ä¸ºæ— æ³•ä¸¤æ¬¡ mixins åŒä¸€ä¸ªæ–‡ä»¶  
å½“ç„¶ä¹Ÿæ˜¯æœ‰è§£å†³æ–¹æ¡ˆçš„å¦‚ï¼š  
```
// åŠ¨æ€ç”Ÿæˆmixin
function genNameMixin(key, funcKey) {
  return {
    data() {
      return {
        [key]: genRandomName()
      }
    },
    methods: {
      [funcKey]: function(v) {
        this.[key] = v
      } 
    }
  }
}

export default {
  mixins: [
    genNameMixin('firstName', 'setFirstName'),
    genNameMixin('lastName', 'setLastName'),
  ]
}
```
é€šè¿‡åŠ¨æ€ç”Ÿæˆ mixin å®Œæˆäº†èƒ½åŠ›çš„å¤ç”¨ï¼Œä½†è¿™æ ·ä¸€æ¥ï¼Œæ— ç–‘æ›´åŠ åœ°å¢å¤§äº†ç¨‹åºçš„å¤æ‚æ€§ï¼Œé™ä½äº†å¯è¯»æ€§ã€‚  
**Hook çš„çŠ¶æ€å¤ç”¨å†™æ³•ï¼š**  
```
// å•ä¸ªnameçš„å†™æ³•
const { name, setName } = useName();

// å¤šä¸ªçš„å†™æ³•
const { name : firstName, setName : setFirstName } = useName();

const { name : secondName, setName : setSecondName } = useName();
```
ç›¸æ¯”äº mixinsçš„ä¼˜ç‚¹ï¼š
1. æ–¹æ³•å’Œå±æ€§å¥½è¿½æº¯ï¼Œè°äº§ç”Ÿçš„ï¼Œå“ªå„¿æ¥çš„ä¸€ç›®äº†ç„¶
2. æ²¡æœ‰é‡åã€è¦†ç›–é—®é¢˜ï¼Œå†…éƒ¨çš„å˜é‡åœ¨é—­åŒ…å†…ï¼Œè¿”å›çš„å˜é‡æ”¯æŒå®šä¹‰åˆ«å
3. å¤šæ¬¡ä½¿ç”¨

### ä»£ç ç»„ç»‡
ä¸€ä¸ªé¡µé¢ä¸­ï¼ŒNä»¶äº‹æƒ…çš„ä»£ç åœ¨ä¸€ä¸ªç»„ä»¶å†…äº’ç›¸çº ç¼ ç¡®å®æ˜¯åœ¨ Hooks å‡ºç°ä¹‹å‰éå¸¸å¸¸è§çš„ä¸€ç§çŠ¶æ€ã€‚é‚£ä¹ˆ Hooks å†™æ³•åœ¨ä»£ç ç»„ç»‡ä¸Šç©¶ç«Ÿèƒ½å¸¦æ¥æ€æ ·çš„æå‡å‘¢ï¼Ÿ  
æ— è®ºæ˜¯ vue è¿˜æ˜¯ react, é€šè¿‡ Hooks å†™æ³•éƒ½èƒ½åšåˆ°ï¼Œå°†â€œåˆ†æ•£åœ¨å„ç§å£°æ˜å‘¨æœŸé‡Œçš„ä»£ç å—â€ï¼Œé€šè¿‡ Hooks çš„æ–¹å¼å°†ç›¸å…³çš„å†…å®¹èšåˆåˆ°ä¸€èµ·ã€‚  
è¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼šâ€œé«˜åº¦èšåˆï¼Œå¯é˜…è¯»æ€§æå‡â€ã€‚ä¼´éšè€Œæ¥çš„ä¾¿æ˜¯ â€œæ•ˆç‡æå‡ï¼Œbugå˜å°‘â€ã€‚
### æ¯” class ç»„ä»¶æ›´å®¹æ˜“ç†è§£
åœ¨ react çš„ class å†™æ³•ä¸­ï¼Œéšå¤„å¯è§å„ç§å„æ ·çš„ .bind(this)ã€‚vueçš„computed: { a: () => { this } } é‡Œçš„ this ä¹Ÿæ˜¯ undefinedã€‚ç»‘å®šè™½ç„¶â€œå¿…è¦â€ï¼Œä½†å¹¶ä¸æ˜¯â€œä¼˜ç‚¹â€ï¼Œåè€Œæ˜¯â€œæ•…éšœé«˜å‘â€åœ°æ®µã€‚åœ¨Hooks å†™æ³•ä¸­ï¼Œå°±å®Œå…¨ä¸å¿…æ‹…å¿ƒ this çš„é—®é¢˜äº†
## å¼€å§‹ä½¿ç”¨hooks
**ç¯å¢ƒå’Œç‰ˆæœ¬**  
åœ¨ react é¡¹ç›®ä¸­ï¼Œ react çš„ç‰ˆæœ¬éœ€è¦é«˜äº 16.8.0ã€‚  
åœ¨ vue é¡¹ç›®ä¸­ï¼Œ vue3.x æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œä½† vue2.6+ é…åˆ @vue/composition-apiï¼Œä¹Ÿå¯ä»¥å¼€å§‹äº«å—â€œç»„åˆå¼APIâ€çš„å¿«ä¹ã€‚
**react çš„ Hooks å†™æ³•**
```
// my-component.js
import { useState, useEffect } from 'React'

export default () => {
  // é€šè¿‡ useState å¯ä»¥åˆ›å»ºä¸€ä¸ª çŠ¶æ€å±æ€§ å’Œä¸€ä¸ªèµ‹å€¼æ–¹æ³•
  const [ name, setName ] = useState('')

  // é€šè¿‡ useEffect å¯ä»¥å¯¹å‰¯ä½œç”¨è¿›è¡Œå¤„ç†
  useEffect(() => {
    console.log(name)
  }, [ name ])

  // é€šè¿‡ useMemo èƒ½ç”Ÿæˆä¸€ä¸ªä¾èµ– name çš„å˜é‡ message
  const message = useMemo(() => {
    return `hello, my name is ${name}`
  }, [name])

  return <div>{ message }</div>
}
```
**vue çš„ Hooks å†™æ³•**
```
<template>
  <div>
    {{ message }}
  </div>
</template>
<script setup>
import { computed, ref } from 'vue'
// å®šä¹‰äº†ä¸€ä¸ª ref å¯¹è±¡
const name = ref('')
// å®šä¹‰äº†ä¸€ä¸ªä¾èµ– name.value çš„è®¡ç®—å±æ€§
const message = computed(() => {
  return `hello, my name is ${name.value}`
})
</script>
```
**Reacå®è·µ**  
```
const { name, setName } = useName();
// éšæœºç”Ÿæˆä¸€ä¸ªçŠ¶æ€å±æ€§ nameï¼Œå®ƒæœ‰ä¸€ä¸ªéšæœºåä½œä¸ºåˆå§‹å€¼
// å¹¶ä¸”æä¾›äº†ä¸€ä¸ªå¯éšæ—¶æ›´æ–°è¯¥å€¼çš„æ–¹æ³• setName

import React from 'react';

export const useName = () => {
  // è¿™ä¸ª useMemo å¾ˆå…³é”®
  const randomName = React.useMemo(() => genRandomName(), []);
  const [ name, setName ] = React.useState(randomName)

  return {
    name,
    setName
  }
}
```
ä¸ºä»€ä¹ˆä¸ç›´æ¥è¿™æ ·å†™ï¼š
```
const [ name, setName ] = React.useState(genRandomName())
```
å› ä¸ºè¿™æ ·å†™æ˜¯ä¸å¯¹çš„ï¼Œæ¯æ¬¡ä½¿ç”¨è¯¥ Hook çš„å‡½æ•°ç»„ä»¶è¢«æ¸²æŸ“ä¸€æ¬¡æ—¶ï¼ŒgenRandom() æ–¹æ³•å°±ä¼šè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè™½ç„¶ä¸å½±å“ name çš„å€¼ï¼Œä½†å­˜åœ¨æ€§èƒ½æ¶ˆè€—ï¼Œç”šè‡³äº§ç”Ÿå…¶ä»– bugã€‚  
å¯ä»¥é€šè¿‡ React.useState(() => randomName()) ä¼ å‚æ¥é¿å…é‡å¤æ‰§è¡Œï¼Œè¿™æ ·å°±ä¸éœ€è¦ useMemo äº†  
**Vueå®è·µ**  
```
import { ref } from 'vue';

export const useName = () => {
  const name = ref(genRandomName())
  const setName = (v) => {
    name.value = v
  }
  return {
    name,
    setName
  }
}
```
**vue å’Œ react è‡ªå®šä¹‰ Hook çš„å¼‚åŒ**  
ç›¸ä¼¼ç‚¹ï¼š æ€»ä½“æ€è·¯æ˜¯ä¸€è‡´çš„ éƒ½éµç…§ç€ "å®šä¹‰çŠ¶æ€æ•°æ®"ï¼Œ"æ“ä½œçŠ¶æ€æ•°æ®"ï¼Œ"éšè—ç»†èŠ‚" ä½œä¸ºæ ¸å¿ƒæ€è·¯ã€‚    
å·®å¼‚ç‚¹ï¼švue3 çš„ç»„ä»¶é‡Œï¼Œ setup æ˜¯ä½œä¸ºä¸€ä¸ªæ—©äº â€œcreatedâ€ çš„ç”Ÿå‘½å‘¨æœŸå­˜åœ¨çš„ï¼Œæ— è®ºå¦‚ä½•ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶çš„æ¸²æŸ“è¿‡ç¨‹ä¸­åªä¼šè¿›å…¥ä¸€æ¬¡ã€‚
Reactå‡½æ•°ç»„ä»¶ åˆ™å®Œå…¨ä¸åŒï¼Œå¦‚æœæ²¡æœ‰è¢« memorizedï¼Œå®ƒä»¬å¯èƒ½ä¼šè¢«ä¸åœåœ°è§¦å‘ï¼Œä¸åœåœ°è¿›å…¥å¹¶æ‰§è¡Œæ–¹æ³•ï¼Œå› æ­¤éœ€è¦å¼€é”€çš„å¿ƒæ™ºç›¸æ¯”äºvueå…¶å®æ˜¯æ›´å¤šçš„ã€‚

åŸæ–‡:
[æµ…è°ˆï¼šä¸ºå•¥vueå’Œreactéƒ½é€‰æ‹©äº†HooksğŸ‚ï¼Ÿ](https://juejin.cn/post/7066951709678895141?utm_source=gold_browser_extension)
